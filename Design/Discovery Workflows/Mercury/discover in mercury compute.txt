[root@K09-compute-server-2 ~]# docker ps
CONTAINER ID        IMAGE                                                                                     COMMAND                  CREATED             STATUS              PORTS               NAMES
6fc74827d39c        cloud-docker.cisco.com/mercury-kilo/nova-compute:20160218_0840-mercury-rhel7-osp7         "/usr/bin/my_init /no"   3 weeks ago         Up 10 days                              novacompute_20160218_0840-mercury-rhel7-osp7
5a2483db337d        cloud-docker.cisco.com/mercury-kilo/nova-libvirt:20160218_0840-mercury-rhel7-osp7         "/nova_libvirt_start."   3 weeks ago         Up 10 days                              novalibvirt_20160218_0840-mercury-rhel7-osp7
06ed9cf14841        cloud-docker.cisco.com/mercury-kilo/nova-common:20160218_0840-mercury-rhel7-osp7          "/usr/bin/my_init /no"   3 weeks ago         Up 3 weeks                              novacommon_20160218_0840-mercury-rhel7-osp7
dc1bf7a78ea2        cloud-docker.cisco.com/mercury-kilo/linux-bridge:20160218_0840-mercury-rhel7-osp7         "/usr/bin/my_init /ne"   3 weeks ago         Up 3 weeks                              neutron_linuxbridge_agent_v1
7f7c9a574400        cloud-docker.cisco.com/mercury-kilo/neutron-common:20160218_0840-mercury-rhel7-osp7       "/usr/bin/my_init /ne"   3 weeks ago         Up 3 weeks                              neutron_common_v1
64ae244fa05a        cloud-docker.cisco.com/mercury-kilo/logstash-forwarder:20160218_0840-mercury-rhel7-osp7   "/usr/bin/my_init /st"   3 weeks ago         Up 3 weeks                              logstash_v1
[root@K09-compute-server-2 ~]# vi .bashrc 
# .bashrc

# User specific aliases and functions

alias rm='rm -i'
alias cp='cp -i'
alias mv='mv -i'

# Source global definitions
        . /etc/bashrc
fi
alias monit='docker exec -it monit /bin/bash'
alias rabbit='docker exec -it rabbitmq_v1 /bin/bash'
alias mariadb='docker exec -it mariadb_v1 /bin/bash'
alias keystone='docker exec -it keystone_20160218_0840-mercury-rhel7-osp7 /bin/bash'
alias haproxy='docker exec -it haproxy_v1 /bin/bash'
alias glanceapi='docker exec -it glanceapi_20160218_0840-mercury-rhel7-osp7 /bin/bash'
alias glancer='docker exec -it glancer_20160218_0840-mercury-rhel7-osp7 /bin/bash'
alias neutroncommon='docker exec -it neutron_common_v1 /bin/bash'
alias neutronserver='docker exec -it neutron_server_v1 /bin/bash'
alias dhcpagent='docker exec -it neutron_dhcp_agent_v1 /bin/bash'
alias metadataagent='docker exec -it neutron_metadata_agent_v1 /bin/bash'
alias linuxbridge='docker exec -it neutron_linuxbridge_agent_v1 /bin/bash'
alias l3agent='docker exec -it neutron_l3_agent_v1 /bin/bash'
alias novaapi='docker exec -it novaapi_20160218_0840-mercury-rhel7-osp7 /bin/bash'
alias conductor='docker exec -it novaconduct_20160218_0840-mercury-rhel7-osp7 /bin/bash'
alias novascheduler='docker exec -it novascheduler_20160218_0840-mercury-rhel7-osp7 /bin/bash'
alias libvirt='docker exec -it novalibvirt_20160218_0840-mercury-rhel7-osp7 /bin/bash'
alias compute='docker exec -it novacompute_20160218_0840-mercury-rhel7-osp7 /bin/bash'
alias consoleauth='docker exec -it novaconsoleauth_20160218_0840-mercury-rhel7-osp7 /bin/bash'
alias novncproxy='docker exec -it novanovncproxy_20160218_0840-mercury-rhel7-osp7 /bin/bash'
alias horizon='docker exec -it horizon_20160218_0840-mercury-rhel7-osp7 /bin/bash'
alias cinderscheduler='docker exec -it cinderscheduler_20160218_0840-mercury-rhel7-osp7 /bin/bash'
alias cinderapi='docker exec -it cinderapi_20160218_0840-mercury-rhel7-osp7 /bin/bash'
alias cindervolume='docker exec -it cindervolume_20160218_0840-mercury-rhel7-osp7 /bin/bash'
alias logstash='docker exec -it logstash_v1 /bin/bash'
alias cloudpulse='docker exec -it cloudpulse_server_20160218_0840-mercury-rhel7-osp7 /bin/bash'
alias memcached='docker exec -it memcached_v1 /bin/bash'
alias heatapi='docker exec -it heatapi_20160218_0840-mercury-rhel7-osp7 /bin/bash'
alias heatengine='docker exec -it heatengine_20160218_0840-mercury-rhel7-osp7 /bin/bash'
alias ovsagent='docker exec -it neutron_ovsagent_v1 /bin/bash'
alias ovsdb='docker exec -it ovs_dbserver_v1 /bin/bash'
alias ovsvswitch='docker exec -it ovs_vswitch_v1 /bin/bash'
alias cephmon='docker exec -it ceph-K09-compute-server-2 /bin/bash'
alias dp='docker ps -a --format "table {{.Names}}       {{.Status}}"'
~
[root@K09-compute-server-2 ~]# libvirt
[root@K09-compute-server-2 /]# virsh list
 Id    Name                           State
----------------------------------------------------
 9     instance-000000c2              running
 116   instance-0000045b              running

[root@K09-compute-server-2 /]# virsh dumpaxml 116
error: unknown command: 'dumpaxml'
[root@K09-compute-server-2 /]# virsh dumpxml 116 
<domain type='kvm' id='116'>
  <name>instance-0000045b</name>
  <uuid>0a307daa-064c-465b-8c96-164e9c522720</uuid>
  <metadata>
    <nova:instance xmlns:nova="http://openstack.org/xmlns/libvirt/nova/1.0">
      <nova:package version="2015.1.2-13.el7ost"/>
      <nova:name>koren-test2</nova:name>
      <nova:creationTime>2016-03-27 10:37:59</nova:creationTime>
      <nova:flavor name="m1.tiny">
        <nova:memory>512</nova:memory>
        <nova:disk>1</nova:disk>
        <nova:swap>0</nova:swap>
        <nova:ephemeral>0</nova:ephemeral>
        <nova:vcpus>1</nova:vcpus>
      </nova:flavor>
      <nova:owner>
        <nova:user uuid="b3f51d824eb141c19486429a3b3fea5a">admin</nova:user>
        <nova:project uuid="0af6cbdb0b5d4fa3a3201fe204e52e4b">lab</nova:project>
      </nova:owner>
      <nova:root type="image" uuid="b80dd849-2125-462c-835e-d05fedfadcc9"/>
    </nova:instance>
  </metadata>
  <memory unit='KiB'>524288</memory>
  <currentMemory unit='KiB'>524288</currentMemory>
  <vcpu placement='static'>1</vcpu>
  <cputune>
    <shares>1024</shares>
  </cputune>
  <resource>
    <partition>/machine</partition>
  </resource>
  <sysinfo type='smbios'>
    <system>
      <entry name='manufacturer'>Red Hat</entry>
      <entry name='product'>OpenStack Compute</entry>
      <entry name='version'>2015.1.2-13.el7ost</entry>
      <entry name='serial'>50d570c6-b885-11e5-2b72-00000000000e</entry>
      <entry name='uuid'>0a307daa-064c-465b-8c96-164e9c522720</entry>
    </system>
  </sysinfo>
  <os>
    <type arch='x86_64' machine='pc-i440fx-rhel7.2.0'>hvm</type>
    <boot dev='hd'/>
    <smbios mode='sysinfo'/>
  </os>
  <features>
    <acpi/>
    <apic/>
  </features>
  <cpu mode='host-model'>
    <model fallback='allow'/>
    <topology sockets='1' cores='1' threads='1'/>
  </cpu>
  <clock offset='utc'>
    <timer name='pit' tickpolicy='delay'/>
    <timer name='rtc' tickpolicy='catchup'/>
    <timer name='hpet' present='no'/>
  </clock>
  <on_poweroff>destroy</on_poweroff>
  <on_reboot>restart</on_reboot>
  <on_crash>destroy</on_crash>
  <devices>
    <emulator>/usr/libexec/qemu-kvm</emulator>
    <disk type='network' device='disk'>
      <driver name='qemu' type='raw' cache='writeback' discard='unmap'/>
      <auth username='cinder'>
        <secret type='ceph' uuid='b8bedb88-9e66-4fde-9b90-0423b102c102'/>
      </auth>
      <source protocol='rbd' name='vms/0a307daa-064c-465b-8c96-164e9c522720_disk'>
        <host name='10.23.220.182' port='6789'/>
        <host name='10.23.220.184' port='6789'/>
        <host name='10.23.220.185' port='6789'/>
      </source>
      <backingStore/>
      <target dev='vda' bus='virtio'/>
      <alias name='virtio-disk0'/>
      <address type='pci' domain='0x0000' bus='0x00' slot='0x04' function='0x0'/>
    </disk>
    <controller type='usb' index='0'>
      <alias name='usb'/>
      <address type='pci' domain='0x0000' bus='0x00' slot='0x01' function='0x2'/>
    </controller>
    <controller type='pci' index='0' model='pci-root'>
      <alias name='pci.0'/>
    </controller>
    <interface type='bridge'>
      <mac address='fa:16:3e:73:e7:c7'/>
      <source bridge='brq0a940d5d-8a'/>
      <target dev='tapfb5ce8b1-d8'/>
      <model type='virtio'/>
      <alias name='net0'/>
      <address type='pci' domain='0x0000' bus='0x00' slot='0x03' function='0x0'/>
    </interface>
    <serial type='file'>
      <source path='/var/lib/nova/instances/0a307daa-064c-465b-8c96-164e9c522720/console.log'/>
      <target port='0'/>
      <alias name='serial0'/>
    </serial>
    <serial type='pty'>
      <source path='/dev/pts/6'/>
      <target port='1'/>
      <alias name='serial1'/>
    </serial>
    <console type='file'>
      <source path='/var/lib/nova/instances/0a307daa-064c-465b-8c96-164e9c522720/console.log'/>
      <target type='serial' port='0'/>
      <alias name='serial0'/>
    </console>
    <input type='tablet' bus='usb'>
      <alias name='input0'/>
    </input>
    <input type='mouse' bus='ps2'/>
    <input type='keyboard' bus='ps2'/>
    <graphics type='vnc' port='5901' autoport='yes' listen='10.23.220.188' keymap='en-us'>
      <listen type='address' address='10.23.220.188'/>
    </graphics>
    <video>
      <model type='cirrus' vram='16384' heads='1'/>
      <alias name='video0'/>
      <address type='pci' domain='0x0000' bus='0x00' slot='0x02' function='0x0'/>
    </video>
    <memballoon model='virtio'>
      <stats period='10'/>
      <alias name='balloon0'/>
      <address type='pci' domain='0x0000' bus='0x00' slot='0x05' function='0x0'/>
    </memballoon>
  </devices>
</domain>

[root@K09-compute-server-2 /]# brctl show
bridge name     bridge id               STP enabled     interfaces
brq0a940d5d-8a          8000.923a3eeb8838       no              tapfb5ce8b1-d8
                                                        vxlan-60253
brq8376e8ff-e4          8000.4eeca241a387       no              tap07d6b238-7c
                                                        vxlan-60097
docker0         8000.0242d6b54360       no

[root@K09-compute-server-2 /]# ip link
1: lo: <LOOPBACK,UP,LOWER_UP> mtu 65536 qdisc noqueue state UNKNOWN mode DEFAULT 
    link/loopback 00:00:00:00:00:00 brd 00:00:00:00:00:00
2: mx: <BROADCAST,MULTICAST,UP,LOWER_UP> mtu 1500 qdisc mq state UP mode DEFAULT qlen 1000
    link/ether 00:25:b5:59:51:0e brd ff:ff:ff:ff:ff:ff
3: t: <BROADCAST,MULTICAST,UP,LOWER_UP> mtu 1500 qdisc mq state UP mode DEFAULT qlen 1000
    link/ether 00:25:b5:04:4e:0e brd ff:ff:ff:ff:ff:ff
4: docker0: <NO-CARRIER,BROADCAST,MULTICAST,UP> mtu 1500 qdisc noqueue state DOWN mode DEFAULT 
    link/ether 02:42:d6:b5:43:60 brd ff:ff:ff:ff:ff:ff
11: brq8376e8ff-e4: <BROADCAST,MULTICAST,UP,LOWER_UP> mtu 1450 qdisc noqueue state UP mode DEFAULT 
    link/ether 4e:ec:a2:41:a3:87 brd ff:ff:ff:ff:ff:ff
13: vxlan-60097: <BROADCAST,MULTICAST,UP,LOWER_UP> mtu 1450 qdisc noqueue master brq8376e8ff-e4 state UNKNOWN mode DEFAULT 
    link/ether 4e:ec:a2:41:a3:87 brd ff:ff:ff:ff:ff:ff
26: tap07d6b238-7c: <BROADCAST,MULTICAST,UP,LOWER_UP> mtu 1450 qdisc pfifo_fast master brq8376e8ff-e4 state UNKNOWN mode DEFAULT qlen 500
    link/ether fe:16:3e:82:4d:b0 brd ff:ff:ff:ff:ff:ff
318: brq0a940d5d-8a: <BROADCAST,MULTICAST,UP,LOWER_UP> mtu 1450 qdisc noqueue state UP mode DEFAULT 
    link/ether 92:3a:3e:eb:88:38 brd ff:ff:ff:ff:ff:ff
319: tapfb5ce8b1-d8: <BROADCAST,MULTICAST,UP,LOWER_UP> mtu 1450 qdisc pfifo_fast master brq0a940d5d-8a state UNKNOWN mode DEFAULT qlen 500
    link/ether fe:16:3e:73:e7:c7 brd ff:ff:ff:ff:ff:ff
320: vxlan-60253: <BROADCAST,MULTICAST,UP,LOWER_UP> mtu 1450 qdisc noqueue master brq0a940d5d-8a state UNKNOWN mode DEFAULT 
    link/ether 92:3a:3e:eb:88:38 brd ff:ff:ff:ff:ff:ff
[root@K09-compute-server-2 /]# ip -d link show vxlan-60097
13: vxlan-60097: <BROADCAST,MULTICAST,UP,LOWER_UP> mtu 1450 qdisc noqueue master brq8376e8ff-e4 state UNKNOWN mode DEFAULT 
    link/ether 4e:ec:a2:41:a3:87 brd ff:ff:ff:ff:ff:ff promiscuity 1 
    vxlan id 60097 group 224.0.0.1 dev t srcport 0 0 dstport 8472 ageing 300 addrgenmode eui64 
[root@K09-compute-server-2 /]# ip -d link show vxlan-60253
320: vxlan-60253: <BROADCAST,MULTICAST,UP,LOWER_UP> mtu 1450 qdisc noqueue master brq0a940d5d-8a state UNKNOWN mode DEFAULT 
    link/ether 92:3a:3e:eb:88:38 brd ff:ff:ff:ff:ff:ff promiscuity 1 
    vxlan id 60253 group 224.0.0.1 dev t srcport 0 0 dstport 8472 ageing 300 addrgenmode eui64 

	[root@K09-compute-server-2 /]# ifconfig t
t: flags=4163<UP,BROADCAST,RUNNING,MULTICAST>  mtu 1500
        inet 17.16.3.9  netmask 255.255.255.0  broadcast 17.16.3.255
        ether 00:25:b5:04:4e:0e  txqueuelen 1000  (Ethernet)
        RX packets 50326428  bytes 64263963004 (59.8 GiB)
        RX errors 0  dropped 962473  overruns 0  frame 0
        TX packets 11255962  bytes 1353200517 (1.2 GiB)
        TX errors 0  dropped 0 overruns 0  carrier 0  collisions 0

[root@K09-compute-server-2 /]# this is the vxlan vtep
bash: this: command not found
[root@K09-compute-server-2 /]# and each instance vNIC gets a tap and a bridge and a vxlan interface
bash: and: command not found

[root@K09-compute-server-2 /]# brctl showmacs brq0a940d5d-8a
port no mac addr                is local?       ageing timer
  2     92:3a:3e:eb:88:38       yes                0.00
  2     92:3a:3e:eb:88:38       yes                0.00
  1     fe:16:3e:73:e7:c7       yes                0.00
  1     fe:16:3e:73:e7:c7       yes                0.00
[root@K09-compute-server-2 /]# brctl showmacs brq8376e8ff-e4
port no mac addr                is local?       ageing timer
  2     4e:ec:a2:41:a3:87       yes                0.00
  2     4e:ec:a2:41:a3:87       yes                0.00
  1     fe:16:3e:82:4d:b0       yes                0.00
  1     fe:16:3e:82:4d:b0       yes                0.00

